//ATTENTION:
//  THIS IS SHADE AUTOGENERATED BY
//  THE ADDON SPRITE-SHADER-MIXER
//  ANY MANUAL CHANGES WILL BE REMOVED WHEN THE ADDON
//  UPDATES THIS SHADER.
//  ANYWAY, YOU CAN SAVE THE CURRENT VERSION AS A RESOURCE FILE.
//SHADERS:Pixel Disolve,
shader_type canvas_item;

uniform float opacity : hint_range(0.0, 1.0, 0.01) = 1.;
uniform float dissolve_speed :hint_range(1.,5.) = 2.;
uniform float min_value :hint_range(0,1) = .5;
uniform float max_value :hint_range(0,1) = .7;


uniform bool PIXELDISOLVEANI_active=true;
uniform float PIXELDISOLVE_time:hint_range(0.0, 1.57, 0.001) = 1.0;
uniform vec2 PIXELDISOLVE_custom_resolution = vec2(100,100);


float PIXELDISOLVE_rand(vec2 co){
    return fract(sin(dot(co.xy ,vec2(12.9898,96.233))) * 43758.5453);
}

float sin_range(float x) {
    return min_value + (sin(x) * 0.5 + 0.5) * (max_value - min_value);
}

void pixelDisolve(in vec2 uv, in sampler2D sampler, vec2 size, vec2 pixelSize, inout vec4 color){

	vec2 within_texture_pixel = vec2(floor(uv * PIXELDISOLVE_custom_resolution));
	if(sin(sin_range(TIME * dissolve_speed))  <= PIXELDISOLVE_rand(within_texture_pixel))
		color = vec4(0.0,0.0,0.0,0.0);
}

void fragment() {
	vec4 color = texture(TEXTURE, UV);
	vec2 size = vec2(textureSize(TEXTURE, 0));
	vec2 uv = UV;
	vec2 screen_uv = SCREEN_UV;

	if(PIXELDISOLVEANI_active) pixelDisolve(uv, TEXTURE, size, TEXTURE_PIXEL_SIZE, color);


	color.a*=opacity;
	COLOR=color;
}
