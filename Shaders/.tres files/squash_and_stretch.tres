[gd_resource type="ShaderMaterial" load_steps=2 format=3 uid="uid://bnxdyck2ac4os"]

[sub_resource type="Shader" id="Shader_dylux"]
code = "/*
Squish Sprite Shader by Garmelon (https://github.com/Garmelon)
Documented by Mateus-Carmo31
*/

shader_type canvas_item;

uniform bool uv_mode = false;
uniform float y_factor = 2.0;
uniform float bulge : hint_range(-1,1);

void vertex()
{

	VERTEX.y *= y_factor;
}

float bulge_function(float y)
{
	return sqrt(1.0 - y*y);
}

void fragment()
{
	vec2 uv = UV * 2.0 - 1.0;

	uv.y *= y_factor;

	float displacement = 1.0 + bulge * bulge_function(uv.y);
	uv.y /= displacement;
	
	uv = (uv + 1.0) / 2.0;
	
if (uv_mode)
{
    COLOR = uv.y >= 0.0 && uv.y <= 1.0 ? vec4(uv, 0.0, 1.0) : vec4(vec3(0.0), 1.0);
}
else if (uv.y >= 0.0 && uv.y <= 1.0)
{
    COLOR = texture(TEXTURE, uv);
}
else
{
    COLOR = vec4(0.0);
}

}"

[resource]
shader = SubResource("Shader_dylux")
shader_parameter/uv_mode = false
shader_parameter/y_factor = 2.0
shader_parameter/bulge = 0.135
